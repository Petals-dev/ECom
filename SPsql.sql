USE [Z0001]
GO

/****** Object:  StoredProcedure [dbo].[SP_INSERT_ZOHO_ITEMS]    Script Date: 27-04-2021 09:53:21 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[SP_INSERT_ZOHO_ITEMS](
@ZF02 VARCHAR(50),
@ZF03 VARCHAR(50), 
@ZF04 VARCHAR(500),
@ZF05 VARCHAR(50),
@ZF06 VARCHAR(50),
@ZF07 VARCHAR(50),
@ZF08 VARCHAR(50),
@ZF09 VARCHAR(50),
@ZF10 VARCHAR(20),
@ZF11 VARCHAR(10),
@ZF12 VARCHAR(10),
@ZF13 VARCHAR(10),
@ZF14 VARCHAR(10)
)
AS
BEGIN
	IF(EXISTS(SELECT 1 FROM [dbo].[Z001] WHERE ZF02=@ZF02 and (ZF10<>@ZF10 or ZF11<>@ZF11 or ZF12<>@ZF12 or ZF13<>@ZF13)))
	BEGIN
	-- UPDATE
		UPDATE [dbo].[Z001] SET ZF10=@ZF10,ZF11=@ZF11,ZF12=@ZF12,ZF13=@ZF13,ZF14='UPDATE'
		WHERE ZF02=@ZF02;
	END
	ELSE IF(NOT EXISTS(SELECT 1 FROM [dbo].[Z001] WHERE ZF02=@ZF02))
	BEGIN
	-- ADD
		INSERT INTO [dbo].[Z001](ZF02,ZF03,ZF04,ZF05,ZF06,ZF07,ZF08,ZF09,ZF10,ZF11,ZF12,ZF13,ZF14)
		VALUES (@ZF02,@ZF03,@ZF04,@ZF05,@ZF06,@ZF07,@ZF08,@ZF09,@ZF10,@ZF11,@ZF12,@ZF13,'NEW');
	END
END
GO


